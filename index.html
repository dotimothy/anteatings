<!DOCTYPE html>

<head>
	<title>UCIHacks: Peter The Anteater</title>
</head>

<!--Authors:
	Timothy Do
	Tiffany Mejia
	Christina Wong
-->

<style>
	* {
		font-family: Verdana;
		user-select: none;
	}
	h1 {
		font-size: 2em;
	}
	button {
		font-size: 1.5em; 
		background-color: rgb(147, 211, 248);
		border-radius: 8px;
	}
	#interface {
		width: 50%;
		margin: auto;
		text-align: center;
	}
	.ant {
		user-select: none;
		position: fixed;
	}
	body {
		background: linear-gradient(rgba(255,255,255,0.66), rgba(255,255,255,0.66)),url("aldrichpark.png");
		background-size: 100%;
	}
	@keyframes twitch {
		0% {
			transform: rotate(-45deg);
		}
		50% {
			transform: rotate(45deg); 
		}
		100% {
			transform: rotate(-45deg);
		}
	}
	.alive {
		animation: down 3s 1 linear, twitch 0.5s infinite linear;   
	}

	#scores {
		display: none;
	}

	@keyframes down {
		from {
			top: 5%;
		}
		to {
			top: 70%;
		}
	}

	footer {
		position: fixed;
		bottom: 0%;
	}

	@keyframes leftPeter {
		0% {
			transform: translate(-200%,-20%);
		}
		100% {
			transform: translate(-500%, -20%);
		}
	}

	@keyframes rightPeter {
		0% {
			transform: translate(100%,-40%);
		}
		50% {
			transform: translate(400%, -40%);
		}
		100% {
			transform: translate(400%,250%); 
		}
		
	}
</style>

<script>
	/* 
	* Todo:
	* Randomize Ants(check)
	* Sound Effects!
	* UI
	* Settings
	* Make it Funny!
	* Peter the Anteater :) 
	*/

	let lives, ants, killScore,antCounter, threshold, maxAnts;

	function startGame() {
		alert("Eat All The Ants Before They Eat You!");
		let start = document.getElementById("start");
		let scores = document.getElementById("scores");
		let leftPeter = document.getElementById("peterleft");
		let rightPeter = document.getElementById("peterright");
		scores.style.display = "block";
		start.hidden = true;
		addCookies();
		leftPeter.style.animation = "leftPeter 0.5s 1 linear";
		rightPeter.style.animation = "rightPeter 0.5s 1 linear";
		setTimeout(function() {
			leftPeter.style.transform = "translate(-500%,-20%)";
			rightPeter.style.transform = "translate(400%,250%)";
		},500);
		lives = 3, ants = 1, killScore = 0, antCounter = 0, threshold = 200, maxAnts = 20;
		updateScores(); 
		for(antCounter = 0; antCounter * (.05*window.innerWidth) < window.innerWidth; antCounter++) {
			if (!antCounter) {
				drawAnt();	
			}
			else {
				setTimeout(drawAnt,threshold*antCounter);
			}
		}
		
	}

	function updateScores() {
		let kill = document.getElementById("killCounter");
		let live = document.getElementById("liveCounter");
		kill.innerHTML = "<h2>Ant Deaths: " + killScore + "</h2>";
		let i;
		let hearts = "";
		live.innerHTML = "<h2>Lives: </h2>";
		for(i = 1; i <= 3; i++) {
			if(i <= lives) {
				hearts += "<img src=\"heart.png\" width=\"5%\">";
			}
			else {
				hearts += "<img src=\"blackheart.png\" width=\"5%\">";
			}
		}
		live.innerHTML += hearts;
		setTimeout(function() {
			let lose = !lives;
			let win = (ants == antCounter+1 && killScore >= ants-(3-lives+1));
			if(lose) {
			alert("You are Dinner.");
			window.location.reload();
			}
			else if(win) {
			alert("You Survived.");
			window.location.reload();
			}
		},100);
	}

	function drawAnt() {
		let spawn = document.getElementById("spawn");
		let id = "ant" + ants;
		let random = Math.trunc(Math.random()*(maxAnts-1) + 1);
		//let spacer = random + " ";
		//document.write(spacer);
		let transformPercent = (random - 1)*5;
		let ant = HTMLify("<img draggable=\"false\" onload=\"takeLife('" + id + "')\" src=\"ant.PNG\" width=\"5%\" class=\"ant alive\" style=\"left: " + transformPercent + "%\" id=\"" + id + "\" onclick=killAnt('" + id + "')>");
		spawn.appendChild(ant);
		ants++;
	}

	function killAnt(antID){
		++killScore;
		let ant = document.getElementById(antID);
		ant.remove();
		updateScores();
	}

	function takeLife(antID) {
		let ant = document.getElementById(antID);
		ant.addEventListener('animationend', () => {
			ant.remove();
			--lives;
			updateScores();
		});
	}

	function HTMLify(txt) {
		let div = document.createElement('div');
		div.innerHTML = txt;
		return div.firstElementChild;
	}

	function addCookies() {
		let cookie = document.getElementById("cookies");
		let line = "<h1 font>";
		let cookieLength = widthOf("<h1>üç™</h1>");
		console.log(cookieLength);
		for(let i = 0; i < Math.trunc(window.innerWidth/cookieLength); i += 1) {
			line += 'üç™';
		}
		line += "<\h1>";
		cookies.innerHTML = line;
	}

	function widthOf(text) {
		let div = document.createElement('div');
		div.innerHTML = text;
		div.style.display = 'inline-block';
		div.style.position = 'fixed';
		div.style.opacity = 0;
		div.style.pointerEvents = 'none';
		document.body.appendChild(div);
		let width = div.getBoundingClientRect().width;
		div.remove();
		return width;
	}
</script>


<body>
	<!--Christina Work-->
	<div id="interface">
	<div id="title">
	<h1>Peter's Ant Eatings</h1>
	
	<img id="peterleft" src="peter.png" style="position: fixed; transform: translate(-200%,-20%); width: 10%">
	
	<div id="welcome">
	<button id="start" onclick="startGame()">Start</button>
	
	<br>
	
	<div id="images" hidden>
	<img id="aldrich" src="aldrichpark.png">
	<img id="ant" src="ant.PNG" width="10%" height="10%">
	<img src="peter.png">
	<img src="peter2.png">
	<img src="heart.png" width="10%">
	</div>


	</div>

	<img id="peterright" src="peter2.png" style="position: fixed; transform: translate(100%,-40%); width: 10%;">

	</div>

	</div>

	<div id="spawn">
	</div>

	
</body>


<footer>
<div id="scores">
<div id="cookies"></div>
<div id="killCounter"><h2>Ant Deaths: </h2></div>
<div id="liveCounter"><h2>Lives: </h2></div>	
</div>
</footer>

</html>