<!DOCTYPE html>

<head>
	<title>UCIHacks: Peter The Anteater</title>
</head>

<!--Authors:
	Timothy Do
	Tiffany Mejia
	Christina Wong
-->

<style>
	@import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap');
	* {
		font-family: Bebas Neue;
		user-select: none;
	}
	body {
		animation: fadein 1s 1 linear;
	}
	@keyframes fadein {
		0% {
			
		}

	}
	h1 {
		font-size: 3em;
		display: inline-block;
	}
	button {
		font-size: 2.5em; 
		background-color: rgb(194, 219, 235);
		border-radius: 8px;
		padding: 6px;
	}
	button:hover {
		opacity: 0.75;
	}
	button:active {
		transform: translateY(3px);
	}
	#title {
		background-color: rgb(236, 230, 134);
		padding: 5px;
		border: black;
	}
	#interface {
		width: 50%;
		margin: auto;
		text-align: center;
	}
	.ant {
		user-select: none;
		position: fixed;
	}
	body {
		background: linear-gradient(rgba(255,255,255,0.2),rgba(255, 255, 255, 0.2)),url("originalpark.jpg");
		background-size: 100%;
	}
	@keyframes twitch {
		0% {
			transform: rotate(-45deg);
		}
		50% {
			transform: rotate(45deg); 
		}
		100% {
			transform: rotate(-45deg);
		}
	}
	.alive {
		animation: down 3s 1 linear, twitch 0.5s infinite linear;   
	}

	#scores {
		display: none;
		line-height: 80%;
	}

	#easy {
		background-color:lime;
	}
	#medium {
		background-color: yellow;
	}
	#hard {
		background-color: red;
	}
	@keyframes down {
		from {
			top: 10%;
		}
		to {
			top: 70%;
		}
	}

	footer {
		position: fixed;
		bottom: 0%;
	}

	@keyframes leftPeter {
		0% {
			transform: translate(-280%, 48%);
		}
		100% {
			transform: translate(-560%, 48%);
		}
	}

	@keyframes rightPeter {
		0% {
			transform: translate(105%,-57%);
		}
		50% {
			transform: translate(400%, -40%);
		}
		100% {
			transform: translate(400%,200%); 
		}
	}

	a:hover {
		opacity: 0.5
	}
</style>

<script>
	/* 
	* Todo:
	* Randomize Ants(check)
	* Sound Effects!(almost)
	* UI
	* Settings
	* Make it Funny! (check)
	* Peter the Anteater :) (check)
	*/

	let maxLives, lives, ants, killScore,antCounter, threshold, maxAnts, level;

	function startGame(difficulty) {
		level = difficulty;
		switch(difficulty) {
			case "easy": {
				alert("Squash All Them Ants!"); 
				break;
			}
			case "medium": {
				alert("Eat All the Ants Before They Eat You!");
				break;				
			}	
			case "hard": {
				alert("You Will Be Eaten!");
				break;
			}	 		
		}
		let start = document.getElementById("start");
		let scores = document.getElementById("scores");
		let leftPeter = document.getElementById("peterleft");
		let rightPeter = document.getElementById("peterright");
		scores.style.display = "block";
		start.hidden = true;
		addCookies();
		leftPeter.style.animation = "leftPeter 0.5s 1 linear";
		rightPeter.style.animation = "rightPeter 0.5s 1 linear";
		setTimeout(function() {
			leftPeter.style.transform = "translate(-560%, 48%)";
			rightPeter.style.transform = "translate(400%, 200%)";
		},500);
		lives = maxLives, ants = 1, killScore = 0, antCounter = 0,  //medium
		updateScores(); 
		for(antCounter = 0; antCounter * (window.innerWidth/maxAnts) < window.innerWidth; antCounter++) {
			if (!antCounter) {
				drawAnt();	
			}
			else {
				setTimeout(drawAnt,threshold*antCounter);
			}
		}
	}

	function easy() {
		maxLives = 10;
		maxAnts = 20;
		threshold = 1200;
		startGame('easy');
	}

	function medium() {
		maxLives = 5;
		maxAnts = 50;
		threshold = 800;
		let warning = document.getElementById("warning");
		warning.currentTime = 0;
		warning.play();
		setTimeout(function() {
			startGame('medium');
		},800);
	}

	function hard() {
		let eaten = document.getElementById("eaten");
		eaten.currentTime = 0;
		eaten.play();
		maxLives = 3;
		maxAnts = 100;
		threshold = 400;
		setTimeout(function() {
			startGame('hard');
		}, 400);
	}
	
	function updateScores() {
		let kill = document.getElementById("killCounter");
		let live = document.getElementById("liveCounter");
		kill.innerHTML = "<h2>Ant Deaths: " + killScore + "</h2>";
		let i;
		let hearts = "";
		live.innerHTML = "<h2>Lives: </h2>";
		for(i = 1; i <= maxLives; i++) {
			if(i <= lives) {
				hearts += "<img src=\"heart.png\" width=\"3%\">";
			}
			else {
				hearts += "<img src=\"blackheart.png\" width=\"3%\">";
			}
		}
		live.innerHTML += hearts;
		setTimeout(function() {
			let lose = (lives <= 0);
			let win = (ants == antCounter+1 && killScore >= ants-(maxLives-lives+1));
			if(lose) {
				alert("You are Dinner.");
				window.location.reload();
			}
			else if(win) {
				alert("You Survived.");
				window.location.reload();
			}
		},100);
	}

	function drawAnt() {
		let spawn = document.getElementById("spawn");
		let id = "ant" + ants;
		let random = Math.trunc(Math.random()*(16) + 3);
		//let spacer = random + " ";
		//document.write(spacer);
		//let antWidth
		let transformPercent = (random - 1)*5;
		let ant = HTMLify("<img draggable=\"false\" onload=\"takeLife('" + id + "')\" src=\"ant.PNG\" width=\"5%\" class=\"ant alive\" style=\"left: " + transformPercent + "%\" id=\"" + id + "\" onclick=killAnt('" + id + "')>");
		spawn.appendChild(ant);
		ants++;
	}

	function killAnt(antID){
		++killScore;
		let slurp = document.getElementById("slurp");
		slurp.currentTime = 0;
		slurp.play();
		let ant = document.getElementById(antID);
		ant.remove();
		updateScores();
	}

	//working
	function takeLife(antID) {
		let ant = document.getElementById(antID);
		ant.addEventListener('animationend', () => {
			let audio;
			switch(level) {
				case "easy": {
					audio = document.getElementById("owie");
					break;
				}
				case "medium": {
					audio = document.getElementById("owie");
					break;
				}
				case "hard": {
					audio = document.getElementById("haha");	
					break;	
				}
			}
			//audio.currentTime = 0;
			audio.playbackRate =  2-threshold/1500;
			audio.play();
			
			ant.remove();
			--lives;
			updateScores();
			document.body.style.background = "linear-gradient(rgba(255,0,0,0.3),rgba(255, 0, 0, 0.3)),url(\"originalpark.jpg\")";
			document.body.style.backgroundSize = "100%";	
			setTimeout(function() { 
				document.body.style.background = "linear-gradient(rgba(255,255,255,0.2),rgba(255, 255, 255, 0.2)),url(\"originalpark.jpg\")";
				document.body.style.backgroundSize = "100%";
			}, 100);
		});
	}


	function HTMLify(txt) {
		let div = document.createElement('div');
		div.innerHTML = txt;
		return div.firstElementChild;
	}

	function addCookies() {
		let cookie = document.getElementById("cookies");
		let line = "<h1>";
		let cookieLength = widthOf("<h1 id=\"cookie\">üç™</h1>");
		for(let i = 0; i < Math.trunc(window.innerWidth/cookieLength); i += 1) {
			line += 'üç™';
		}
		line += "<\h1>";
		cookies.innerHTML = line;
		//document.getElementById("cookie").remove();
	}

	function widthOf(text) {
		let div = document.createElement('div');
		div.innerHTML = text;
		div.style.display = 'inline-block';
		div.style.position = 'fixed';
		div.style.opacity = 0;
		div.style.pointerEvents = 'none';
		document.body.appendChild(div);
		let width = div.getBoundingClientRect().width;
		div.remove();
		return width;
	}
</script>


<body>
	<div id="interface">
	<h1 id="title">üêú Peter's Ant Eatings üêú</h1>
	<img id="peterleft" src="peter.png" style="position: fixed; transform: translate(-280%, 48%); width: 10%">
	
	<div id="welcome">
	<div id="start">
	<button id="easy" onclick="easy()">Easy</button>
	<br><br>
	<button id="medium" onclick="medium()">Medium</button>
	<br><br>
	<button id="hard" onclick="hard()">Hard</button>
	</div>

	<div id="media" hidden>
	<img id="aldrich" src="aldrichpark.png">
	<img id="ant" src="ant.PNG" width="10%" height="10%">
	<img src="peter.png">
	<img src="peter2.png">
	<img src="heart.png" width="10%">
	<audio controls id="eaten">
		<source src="eaten.wav">
	</audio>
	<audio controls id="haha">
		<source src="haha.wav">
	</audio>
	<audio controls id="warning">
		<source src="warning.wav">
	</audio>
	<audio controls id="owie">
		<source src="owie.wav">
	</audio>
	<audio controls id="slurp">
		<source src="slurp.wav">
	</audio>
	</div>

	</div>

	<img id="peterright" src="peter2.png" style="position: fixed; transform: translate(105%,-57%); width: 10%;">

	</div>

	<div id="spawn">
	</div>

	
</body>


<footer>
<div id="scores">
<div id="cookies"></div>
<div id="killCounter"><h2>Ant Deaths: </h2></div>
<div id="liveCounter"><h2>Lives: </h2></div>
<a onclick="window.location.reload()"><h2>Restart</h2></a>
</div>
</footer>

</html>